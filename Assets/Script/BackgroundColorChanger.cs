using UnityEngine;
using System.Collections;

public class BackgroundColorChanger : MonoBehaviour
{
    public Color[] colors; // ????????????????????????
    public float colorChangeInterval; // ????????????????????????????
    public float fadeDuration; // ????????????????????????? fade ??
    private int currentColorIndex = 0; // ???? index ?????????????
    private Camera mainCamera; // ???? component ??? main camera

    void Start()
    {
        mainCamera = Camera.main;
        InvokeRepeating("ChangeBackgroundColor", colorChangeInterval, colorChangeInterval); // ???????????????????????????????? invoke ?????? ChangeBackgroundColor ???????????????????
    }

    IEnumerator FadeColor(Color startColor, Color endColor, float duration)
    {
        float time = 0;
        while (time < duration)
        {
            time += Time.deltaTime;
            float t = time / duration;
            mainCamera.backgroundColor = Color.Lerp(startColor, endColor, t);
            yield return null;
        }
    }

    void ChangeBackgroundColor()
    {
        Color startColor = mainCamera.backgroundColor;
        currentColorIndex++; // ??????? index ?????
        if (currentColorIndex >= colors.Length) // ??? index ??????????? array ??
        {
            currentColorIndex = 0; // ????? index ???????????? 0
        }
        Color endColor = colors[currentColorIndex]; // ?????????????????????
        StartCoroutine(FadeColor(startColor, endColor, fadeDuration));
    }
}
